"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.signerSpec = void 0;
/*
 * @Author: XY | The Findables Company <ryanxyo>
 * @Date:   Friday, 14th December 2018 12:21:03 pm
 * @Email:  developer@xyfindables.com
 * @Filename: xyo-signing-test-utils.ts
 * @Last modified by: ryanxyo
 * @Last modified time: Friday, 14th December 2018 12:21:41 pm
 * @License: All Rights Reserved
 * @Copyright: Copyright XY | The Findables Company
 */
// The spec below is written against the interface of a IXyoSignerProvider and IXyoSigner
function signerSpec(signerProvider) {
    let signer;
    describe(signerProvider.constructor.name, () => {
        beforeEach(() => {
            signer = signerProvider.newInstance();
        });
        it(`Should sign and verify correct data, and not verify bad data`, () => __awaiter(this, void 0, void 0, function* () {
            const data = Buffer.from('hello world');
            const signature = yield signer.signData(data);
            const shouldVerifyResult = yield signature.verify(data, signer.publicKey);
            expect(shouldVerifyResult).toBe(true);
            const shouldNotVerifyResult = yield signature.verify(Buffer.from('wrong data'), signer.publicKey);
            expect(shouldNotVerifyResult).toBe(false);
        }));
    });
}
exports.signerSpec = signerSpec;
//# sourceMappingURL=xyo-signing-test-utils.js.map