import { IStatus, getIp } from '@xyo-network/pi-wifi-manager'
import { IContext } from '../../@types'

export const networkQuery = () => ({
  async ip(_parent: any, _args: any, _ctx: IContext): Promise<string | null> {
    return getIp()
  },

  async port(_parent: any, _args: any, ctx: IContext): Promise<number> {
    return ctx.port
  },

  async url(_parent: any, _args: any, ctx: IContext): Promise<string | null> {
    const ip = getIp()
    if (!ip) return null
    return `http://${ ip }:${ ctx.port }`
  },

  async network(_parent: any, _args: any, { wifi }: IContext): Promise<IStatus | undefined> {
    return wifi.getStatus()
  },

  async scan(_parent: any, _args: any, { wifi }: IContext): Promise<IStatus[]> {
    return wifi.scan()
  }
})
